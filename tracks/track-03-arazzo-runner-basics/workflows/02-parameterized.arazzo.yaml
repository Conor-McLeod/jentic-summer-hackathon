arazzo: 1.0.0
info:
  title: Parameterized Workflow
  description: Workflow that accepts input parameters and demonstrates data flow
  version: 1.0.0

workflows:
  - workflowId: searchAndTranslate
    description: Search for content and translate it to fun languages
    inputs:
      type: object
      properties:
        search_query:
          type: string
          description: What to search for
          example: "artificial intelligence"
        target_language:
          type: string
          description: Language to translate to
          default: "yoda"
          enum: ["yoda", "sith", "shakespeare", "pirate", "minion"]
        max_results:
          type: integer
          description: Maximum number of search results to process
          default: 1
          minimum: 1
          maximum: 5
      required: [search_query]
    
    steps:
      - stepId: searchDuckDuckGo
        description: Search DuckDuckGo for information
        operationRef: '#/operations/duckDuckGoSearch'
        parameters:
          q: $inputs.search_query
          format: json
          no_html: 1
          skip_disambig: 1
        outputs:
          search_results: $response.body.RelatedTopics
          abstract: $response.body.Abstract
          answer: $response.body.Answer

      - stepId: translateText
        description: Translate the search result using Fun Translations API
        operationRef: '#/operations/funTranslate'
        parameters:
          text: $steps.searchDuckDuckGo.outputs.abstract || $steps.searchDuckDuckGo.outputs.answer || "No information found"
          translate_to: $inputs.target_language
        dependsOn: [searchDuckDuckGo]
        outputs:
          translated_text: $response.body.contents.translated
          original_text: $response.body.contents.text
          translation_type: $response.body.contents.translation

      - stepId: getRandomFact
        description: Get a random interesting fact as bonus content
        operationRef: '#/operations/getRandomFact'
        outputs:
          random_fact: $response.body.text
          fact_id: $response.body.id

      - stepId: translateFact
        description: Translate the random fact to the same language
        operationRef: '#/operations/funTranslate'
        parameters:
          text: $steps.getRandomFact.outputs.random_fact
          translate_to: $inputs.target_language
        dependsOn: [getRandomFact, translateText]
        outputs:
          translated_fact: $response.body.contents.translated

operations:
  - operationId: duckDuckGoSearch
    method: GET
    url: https://api.duckduckgo.com/
    description: Search DuckDuckGo for information
    parameters:
      - name: q
        in: query
        required: true
        schema:
          type: string
        description: Search query
      - name: format
        in: query
        required: false
        schema:
          type: string
          default: json
        description: Response format
      - name: no_html
        in: query
        required: false
        schema:
          type: integer
          default: 1
        description: Remove HTML from results
      - name: skip_disambig
        in: query
        required: false
        schema:
          type: integer
          default: 1
        description: Skip disambiguation

  - operationId: funTranslate
    method: GET
    url: https://api.funtranslations.com/translate/{translate_to}.json
    description: Translate text using Fun Translations API
    parameters:
      - name: text
        in: query
        required: true
        schema:
          type: string
        description: Text to translate
      - name: translate_to
        in: path
        required: true
        schema:
          type: string
        description: Target language/style

  - operationId: getRandomFact
    method: GET
    url: https://uselessfacts.jsph.pl/random.json?language=en
    description: Get a random interesting fact