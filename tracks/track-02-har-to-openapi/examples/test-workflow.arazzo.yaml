arazzo: 1.0.0
info:
  title: Test Discovered API
  description: Workflow to test the API specification created from HAR analysis
  version: 1.0.0

workflows:
  - workflowId: testDiscoveredAPI
    description: Test the main functionality of the discovered API
    inputs:
      type: object
      properties:
        search_term:
          type: string
          description: Term to search for
          default: "test"
        api_token:
          type: string
          description: API authentication token
      required: [api_token]
    
    steps:
      - stepId: searchItems
        description: Test the search functionality
        operationRef: '../specs/api-spec.yaml#/operations/searchItems'
        parameters:
          query: $inputs.search_term
          limit: 5
          sort: "relevance"
        outputs:
          search_results: $response.body.results
          total_count: $response.body.total
          first_item_id: $response.body.results[0].id

      - stepId: getItemDetails
        description: Get details for the first search result
        operationRef: '../specs/api-spec.yaml#/operations/getItemById'
        parameters:
          id: $steps.searchItems.outputs.first_item_id
        dependsOn: [searchItems]
        condition: $steps.searchItems.outputs.total_count > 0
        outputs:
          item_details: $response.body
          item_title: $response.body.title
          item_price: $response.body.price

      - stepId: getCategories
        description: Test the categories endpoint
        operationRef: '../specs/api-spec.yaml#/operations/getCategories'
        outputs:
          available_categories: $response.body.categories
          category_count: $response.body.categories.length

      - stepId: categorySearch
        description: Search within a specific category
        operationRef: '../specs/api-spec.yaml#/operations/searchItems'
        parameters:
          query: $inputs.search_term
          category: "electronics"
          limit: 3
        dependsOn: [getCategories]
        outputs:
          category_results: $response.body.results
          category_total: $response.body.total

operations: []  # Operations are referenced from the main API spec file